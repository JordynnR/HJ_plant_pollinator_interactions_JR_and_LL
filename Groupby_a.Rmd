---
title: "Groupby_a"
author: "Lily"
date: "2025-11-25"
output: html_document
---
```{r}

library(terra)
library(ggplot2)
library(dplyr)

#loading in cleaned data file

clean_data <- read.csv("clean_data/HJ_data.csv")

clean_data
```

```{r}
#Check the count of observations for native vs non-native pollinators
clean_data %>%
  group_by(NativePollinator) %>%
  summarise(count = n())
#13579 non native bee individuals
#15974 native bee individuals

clean_data %>%
  group_by(NativePlant) %>%
  summarise(count = n())
#1207 non native plants 
#28346 native plants 

```

```{r}
#creating a summary of the plant, whether non native bees were observed, and the abundance of native bee records 

plants <- clean_data %>%
  group_by(PlantGenusSpecies, NativePlant) %>%
  summarise(non_nativebee_count = sum(NativePollinator == 0),
            nativebee_count = sum(NativePollinator ==1))
plants
table(plants$non_nativebee_count)
#time to see if there is a difference in the counts of native bees due to the presence of non-native bees

```

```{r, warning = FALSE}
#creating scatter plot to compare abundances at each species of plant

ggplot(plants, aes(x = non_nativebee_count, y = nativebee_count, color = factor(NativePlant)))+
  geom_smooth(size=0.8)+
  geom_point() +
   scale_color_manual(values = c("darkorange","darkgreen"),
                     labels = c("Non-native plant species", "Native plant species"))+
  labs( x= "Non-native bee abundance",
        y = "Native bee abundance",
        title = "Native vs. Non-native Pollinator Abundance across Native and Non-native\nPlant Species", color = "Plant type")+
  theme(axis.line = element_line(color = "black", size = 0.5))+
  theme(legend.position = c(0.2,0.8))+
  theme(text= element_text(size = 15))+
  facet_wrap(~NativePlant, scale = "free_x")

```
This is the opposite of our predictions. However one can observe a much larger range in native bee abundances for when non native bees are present. FALSE(n=51), TRUE(n=73). This boxplot includes bee observation from both native and non-native plants.  
```{r, warning = FALSE}
#creating second zoomed in plot

ggplot(plants, aes(x = non_nativebee_count, y = nativebee_count, color = factor(NativePlant)))+
  geom_smooth(size =0.8)+
  geom_point() +
  xlim(0,600)+
   scale_color_manual(values = c("darkorange","darkgreen"),
                     labels = c("Non-native plant species", "Native plant species"))+
  labs( x= "Non-native bee abundance",
        y = "Native bee abundance",
        title = "Native vs. Non-native Pollinator Abundance\nacross Native and Non-native Plant Species", color = "Plant type")+
  theme(axis.line = element_line(color = "black", size = 0.5))+
  theme(legend.position = c(0.7,0.8))+
  theme(text= element_text(size = 15))
```


Creating the Phenology Line Plot

```{r}
#Subsetting clean data reading for plotting. 
phenology_plot <- clean_data %>%
  filter(NativePollinator == 1) %>% 
  group_by(Month, NativePlant) %>%
  summarise(native_bee_abundance = n(), .groups = "drop") %>%
  group_by(Month)%>% #total native bee obs per month
  mutate(total_native_bees = sum(native_bee_abundance),
         proportion = native_bee_abundance / total_native_bees) %>% #creating new column 'proportion' by dividing number of native bee observations by total number of bee observations for that month then can compare each month.
  ungroup()

phenology_plot

```

```{r}
#plotting 
ggplot(phenology_plot, aes(x=Month, y=proportion,
                           color = factor(NativePlant), group = NativePlant))+
  geom_line(size = 0.5) +
  geom_point(size = 2) +
  scale_color_manual(values = c("darkorange","darkgreen"),
                     labels = c("Non-native plant species", "Native plant species")) +
  labs(x = "Month",
       y = "Proportion of native pollinator observations",
       color = "Type of plant on which\nthe pollinator was observed",
       title = "Proportion of native pollinator observations\non native vs. non-native plants by month.") +
  theme(axis.line = element_line(color = "black", size = 0.5))+
  theme(legend.position = c(0.6,0.5))+
  theme(text= element_text(size = 15))

```


