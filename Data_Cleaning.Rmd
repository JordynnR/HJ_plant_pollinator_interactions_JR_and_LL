---
title: "Data_cleaning"
output: html_document
date: "2025-11-19"
---

Questions for Rebecca:
2. how to extract month from date column and transform into numeric
3. network- do we need to choose/keep one of the columns in the spreadsheet of the interaction strength values? sankey plot maybe- investigate required inputs
4. would spatial data even be useful to us


columns to keep:
Year
Site??
Genus??
GenusSpecies
PlantGenus
PlantGenusSpecies
Date

```{r}
##need to read data in and start cleaning it up- 
# 1- get rid of unnecessary columns
# 2- figure out what species to keep
raw_data<- read.csv("raw_data/spec_net_copy.csv")

```

##get rid of columns
```{r}
library(tidyverse)
library(dplyr)
##only keeping date, bee species and plant species columns
kept_columns<- raw_data %>%
  select(Date, GenusSpecies, PlantGenusSpecies) %>%
  rename(BeeGenusSpecies= GenusSpecies) %>% #rename GenusSpecies to BeeGenusSpecies to more easily differentiate
  dplyr::filter(BeeGenusSpecies!="")   #get rid of empty rows

```

transform date to month number

```{r}
class(kept_columns) #test class= data frame

#replacing the values in the Date column with only the first number of each, which is the month
kept_columns$Date <- sub("^(\\d{1,2})/.*", "\\1", kept_columns$Date)

#rename Date to Month
kept_columns <- kept_columns%>%
  rename(Month = Date)

kept_columns

table(kept_columns$Month)
```

use regex to filter out spp/sp (unknown) species
```{r}
##create regex to use for filtering
#looks for pattern ending in any variation of spp/sp with any number of "."; got from the class demo
sp_ending_regex <- "(^\\s*[A-Za-z]+\\s+)[sS][pP]{1,2}\\.?\\s*$"
#looks for pattern ending in "sp."+"any numeric" with optional space or . in between; asked copilot
sp_number_regex <- "sp\\.?\\s?[0-9]+$"
#looks for pattern that is only genus; got from class demo
genus_only_regex <-   "^\\s*([A-Za-z]+)\\s*$"

#filter rows that are not (!) in the reg expressions above (had to make 2 for 2 different formats)
no_unknown<- kept_columns %>%
  dplyr::filter(!(BeeGenusSpecies = grepl(sp_ending_regex,BeeGenusSpecies))) %>%
  dplyr::filter(!(BeeGenusSpecies = grepl(sp_number_regex,BeeGenusSpecies))) %>%
  dplyr::filter(!(BeeGenusSpecies = grepl(genus_only_regex,BeeGenusSpecies)))

```
